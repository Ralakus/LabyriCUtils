stages:
- build
- run-example

variables:
    GIT_SUBMODULE_STRATEGY: recursive

build-lib:
    stage: build
    image: fedora:latest
    before_script:
    - apt update
    - apt install gcc git -y
    - git clone git://github.com/gittup/tup.git
    - cd tup
    - ./bootstrap.sh
    - cd ..
    - ./tup/tup
    script:
    - tup
    artifacts:
        paths:
        - build/bin/libLabCUtils.a
        - build/obj/*.o
        - example/build/obj/example.o
        - example/build/bin/example

run-example:
    stage: run-example
    image: ubuntu:latest
    before_script:
    - apt update
    - apt install python3-pip -y
    - pip3 --version
    - pip3 install gcovr
    script:
    - cd examples/build/bin
    - ./example
    - gcovr